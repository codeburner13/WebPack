import { setTitle } from 'meta';
import { mapChunks } from 'format-data';

import {
  hideModuleGraph,
  setActiveChunk,
  showModuleGraph,
} from 'graphs/modules';

export default async (render, options) => {
  const id = Number.parseInt(options.args[1], 10);

  setTitle(`Chunk ${id}`);

  const template = await import('./view.jade');
  render(template.default, {
    chunk: mapChunks[id],
    id,
  });

  setTimeout(() => {
    showModuleGraph();
    setActiveChunk(id);
  }, 0);

  options.registerMethod('componentWillUnmount', () => hideModuleGraph());
};
